<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
            <link rel="shortcut icon" href="img/ribole.jpg" type="image/x-icon">
                <link rel="stylesheet" href="estilos.css">

                    <!-- FIREBASE       -->
                    <script src="https://www.gstatic.com/firebasejs/8.2.4/firebase-app.js"></script>
                    <script src="https://www.gstatic.com/firebasejs/8.2.4/firebase-database.js"></script>
        
                    <!-- GOOGLE MAPS    -->
                    <script scr="https://maps.googleapis.com/maps/api/js?key=AIzaSyDL63WEg7R98C5567DCBfGZhNm-JYKnUfU"></script>

</head>

<body>
    <main>                
        <div class="l-form" >
            <form action="" class="form">
                <h1 class="form_title">Â¿Que deseas ordenar?</h1>

                    <div class="form_div">
                        <input type="text" class="form_input" placeholder="" id="pedidomamon">
                            <label for="" class="form_label">Orden</label>
                    </div>

                    <div class="form_div">
                        <input type="number" class="form_input" placeholder="" id="cel">
                            <label for="" class="form_label">Celular</label>
                    </div>

            </form>
        </div>


    <!--<iframe src="ubicacion.html"></iframe>-->

        <!-- Botones para ubicacion-->
    <BUtton class="btn" onclick="findMe()">Buscar mi ubicacion</BUtton>
    <button class="btn" onclick="shareMe()" >confirmar pedido</button>
    <div id="map"></div>


    <script>

    //FUNCION PARA BUSCARTE ES DECIR OCUPO EL GOOGLE MAPS
    function findMe(){
        var output = document.getElementById('map');
        //VERIFICO SI MI CLIENTE PUEDE SOPORTAR GEOLOCALIZACION
            if(navigator.geolocation){
                output.innerHTML="<p>Tu navegador soporta localizacion</p>";
            }else{
                output.innerHTML="<p>Tu navegador NO soporta localizacion</p>";}
    
    // OBTENGO LA LATITUD Y LONGITUD
    function localizacion(posicion){
            var latitude = posicion.coords.latitude;
            var longitude = posicion.coords.longitude;
            var imgURL="https://maps.googleapis.com/maps/api/staticmap?center="+latitude+","+longitude+"&size=600x300&markers=color:red%7C"+latitude+","+longitude+"&key=AIzaSyDL63WEg7R98C5567DCBfGZhNm-JYKnUfU";
            
            output.innerHTML="<img src='"+imgURL+"'>";
            //output.innerHTML ="<p> Latitude :"+latitude+"<br>Longitude :"+longitude+"<p>"; 
        }

    function error(){
        output.innerHTML="<p>NO se pudo obtener tu ubicacion</p>";
        }
        navigator.geolocation.getCurrentPosition(localizacion,error);
    } 

    //FUNCION PARA COMPARTIR LA UBICACION A MI BASE DE DATOS
    function shareMe(){
        var output = document.getElementById('map');
    
            // OBTENGO LA LATITUD Y LONGITUD
            function localizacion(posicion){
                var latitude = posicion.coords.latitude;
                var longitude = posicion.coords.longitude;
                    const pedido = document.getElementById('pedidomamon').value;
                    const celular = document.getElementById('cel').value;

                            //output.innerHTML ="<p> Latitude :"+latitude+"<br>Longitude :"+longitude+"<p>"; 

                var firebaseRef = firebase.database().ref(celular);
                document.querySelector('#send')
                        firebaseRef.push(pedido);
                        firebaseRef.push(latitude);
                        firebaseRef.push(longitude);
            ; 
            }
            function error(){
                output.innerHTML="<p>NO se pudo compartir  tu ubicacion</p>";
            }
                navigator.geolocation.getCurrentPosition(localizacion,error);
    }                
    </script>   
 
    <!-- AQUI SE ENCUENTRA MI SCRIP PARA PODER CONECTARME CON LA BASE DE DATOS-->
    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCfji_zAhD_qE3T854-HXPBdlAAtIG3fGA",
            authDomain: "dbtula13.firebaseapp.com",
            projectId: "dbtula13",
            storageBucket: "dbtula13.appspot.com",
            messagingSenderId: "696242519810",
            appId: "1:696242519810:web:e8c7b9f19658bbc3bccc1b"
        };
                        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
    </script>    
    </main>
</body>
</html>